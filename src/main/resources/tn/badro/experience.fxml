<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.Cursor?>

<BorderPane fx:id="mainBorderPane" prefHeight="800.0" prefWidth="1200.0" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="tn.badro.Controllers.ExperienceController">
    <top>
        <VBox spacing="0">
            <!-- Top header bar with app name and user profile -->
            <HBox alignment="CENTER_RIGHT" spacing="20" style="-fx-background-color: white; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 10, 0, 0, 3);">
                <padding>
                    <Insets top="20" right="40" bottom="20" left="40"/>
                </padding>
                <Label text="BADRO" style="-fx-font-size: 24px; -fx-font-weight: bold; -fx-text-fill: #4B9CD3;"/>
                <Region HBox.hgrow="ALWAYS"/>
                <HBox fx:id="userInfoSection" alignment="CENTER_RIGHT" spacing="10">
                    <!-- Notification Icon with Badge -->
                    <StackPane fx:id="notificationIconContainer" alignment="CENTER_RIGHT">
                        <ImageView fx:id="NotificationIcon" accessibleRole="LIST_VIEW" fitHeight="30.0" fitWidth="30.0" onMouseClicked="#handleNotificationIconClick" pickOnBounds="true" preserveRatio="true">
                            <image>
                                <Image url="@../icones/notification.gif" />
                            </image>
                            <cursor>
                                <Cursor fx:constant="HAND" />
                            </cursor>
                        </ImageView>
                        <Label fx:id="notificationBadge" text="" visible="false" style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-size: 12px; -fx-background-radius: 10; -fx-padding: 2 6 2 6; -fx-border-radius: 10; -fx-border-width: 0;" StackPane.alignment="TOP_RIGHT" />
                    </StackPane>
                    
                    <Label fx:id="userDisplayName" style="-fx-text-fill: #4B9CD3; -fx-font-size: 14px;"/>
                    <Button fx:id="profileButton" text="Profile" onAction="#showProfile" 
                            style="-fx-background-color: transparent; -fx-border-color: #4B9CD3; -fx-text-fill: #4B9CD3; -fx-font-size: 14px; -fx-padding: 5 15; -fx-background-radius: 5; -fx-border-radius: 5; -fx-cursor: hand;"/>
                    <Button fx:id="returnToMainButton" text="Return to Main Menu" onAction="#returnToMainMenu" 
                            style="-fx-background-color: transparent; -fx-border-color: #4B9CD3; -fx-text-fill: #4B9CD3; -fx-font-size: 14px; -fx-padding: 5 15; -fx-background-radius: 5; -fx-border-radius: 5; -fx-cursor: hand;"/>
                    <Button fx:id="logoutButton" text="Logout" onAction="#handleLogout" 
                            style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-size: 14px; -fx-padding: 5 15; -fx-background-radius: 5; -fx-cursor: hand;"/>
                </HBox>
            </HBox>
            
            <!-- Experience module header -->
            <HBox alignment="CENTER_LEFT" spacing="10.0" style="-fx-background-color: #307D91;">
                <padding>
                    <Insets bottom="15.0" left="20.0" right="20.0" top="15.0" />
                </padding>
                <Label text="Experiences" textFill="WHITE">
                    <font>
                        <Font name="System Bold" size="18.0" />
                    </font>
                </Label>
                <Region HBox.hgrow="ALWAYS" />
                <Button fx:id="btnAddExperience" mnemonicParsing="false" onAction="#onAddExperienceClicked" style="-fx-background-color: white;" text="Share Experience">
                    <graphic>
                        <ImageView fitHeight="16.0" fitWidth="16.0" pickOnBounds="true" preserveRatio="true">
                            <Image url="@images/add_icon.png" />
                        </ImageView>
                    </graphic>
                </Button>
                <Button fx:id="btnMyExperiences" mnemonicParsing="false" onAction="#onMyExperiencesClicked" style="-fx-background-color: white;" text="My Experiences" />
            </HBox>
            
            <!-- Search and filter bar -->
            <VBox style="-fx-background-color: #f4f4f4;">
                <padding>
                    <Insets bottom="12.0" left="20.0" right="20.0" top="12.0" />
                </padding>
                
                <HBox spacing="15.0" alignment="CENTER_LEFT">
                    <Label text="Search:" style="-fx-font-weight: bold;" />
                    <TextField fx:id="searchField" promptText="Search experiences by keyword..." HBox.hgrow="ALWAYS" />
                    <Button fx:id="btnSearch" mnemonicParsing="false" onAction="#onSearchClicked" text="Search" 
                            style="-fx-background-color: #307D91; -fx-text-fill: white;"/>
                </HBox>
                
                <HBox spacing="15.0" alignment="CENTER_LEFT">
                    <padding>
                        <Insets top="8.0" />
                    </padding>
                    
                    <Label text="Filters:" style="-fx-font-weight: bold;" />
                    <ComboBox fx:id="filterComboBox" prefWidth="150.0" promptText="Sort by" />
                    <ComboBox fx:id="destinationFilterComboBox" prefWidth="200.0" promptText="Filter by destination" />
                    <Button fx:id="btnClearFilters" mnemonicParsing="false" onAction="#onClearFiltersClicked" text="Clear Filters" 
                            style="-fx-background-color: #6c757d; -fx-text-fill: white;"/>
                </HBox>
            </VBox>
        </VBox>
    </top>
    
    <center>
        <ScrollPane fitToWidth="true" BorderPane.alignment="CENTER" style="-fx-background-color: #f8f9fa;">
            <VBox fx:id="experiencesContainer" spacing="15.0">
                <padding>
                    <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                </padding>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane> 